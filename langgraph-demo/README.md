# é‡‘èå›¾RAGæ™ºèƒ½é—®ç­”ç³»ç»Ÿ

åŸºäº LangGraph çš„é‡‘èåˆ›ä¸šæŠ•èµ„é¢†åŸŸæ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼Œå®ç°å›¾ RAGï¼ˆæ£€ç´¢-åæ€-è¿­ä»£ï¼‰åŠŸèƒ½ï¼Œæ”¯æŒå¤šç§å‘é‡æ•°æ®åº“ï¼Œä¿è¯é«˜å¯ç”¨å’Œé«˜æ‰©å±•æ€§ã€‚

.envæ–‡ä»¶ä¸è¦å‡ºç°ä¸­æ–‡ï¼ï¼ï¼
## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ” **å›¾RAGæ£€ç´¢å¢å¼º**ï¼šå®ç°æ£€ç´¢-åæ€-è¿­ä»£æ¡†æ¶ï¼ŒåŠ¨æ€ä¼˜åŒ–ç­”æ¡ˆ
- ğŸ’¾ **å¤šå‘é‡æ•°æ®åº“æ”¯æŒ**ï¼šæ”¯æŒ Qdrantã€Milvusã€Weaviate
- ğŸ—ï¸ **é«˜å¯ç”¨æ¶æ„**ï¼šæ”¯æŒæ•…éšœè½¬ç§»å’Œæ•°æ®åº“å¤‡ä»½
- ğŸ“„ **å¤šæ ¼å¼æ–‡æ¡£è§£æ**ï¼šæ”¯æŒ PDFã€DOCXã€PPT ç­‰æ ¼å¼
- ğŸ’¼ **é‡‘èæœ¯è¯­ä¼˜åŒ–**ï¼šé’ˆå¯¹é‡‘èè´¢æŠ¥ã€æŠ•èèµ„æŠ¥å‘Šä¼˜åŒ–åˆ†å—ç­–ç•¥
- ğŸ¨ **æç®€å‰ç«¯**ï¼šåŸºäº Streamlit çš„ç®€æ´ç”¨æˆ·ç•Œé¢

## é¡¹ç›®ç»“æ„

```
src/agent/
â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”œâ”€â”€ graph.py               # ä¸»å›¾å®šä¹‰
â”œâ”€â”€ data_processor/        # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ parser.py         # æ–‡æ¡£è§£æå™¨
â”‚   â””â”€â”€ chunker.py        # æ–‡æ¡£åˆ†å—å™¨
â”œâ”€â”€ vector_store/          # å‘é‡æ•°æ®åº“æ¨¡å—
â”‚   â”œâ”€â”€ base.py           # æŠ½è±¡åŸºç±»
â”‚   â”œâ”€â”€ factory.py        # å·¥å‚ç±»
â”‚   â”œâ”€â”€ qdrant_store.py   # Qdrantå®ç°
â”‚   â”œâ”€â”€ milvus_store.py   # Milvuså®ç°
â”‚   â”œâ”€â”€ weaviate_store.py # Weaviateå®ç°
â”‚   â””â”€â”€ ha_store.py       # é«˜å¯ç”¨åŒ…è£…å™¨
â”œâ”€â”€ rag/                   # å›¾RAGæ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ state.py          # çŠ¶æ€å®šä¹‰
â”‚   â”œâ”€â”€ nodes.py          # èŠ‚ç‚¹å®ç°
â”‚   â””â”€â”€ graph.py          # å›¾å®šä¹‰
â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
    â””â”€â”€ embedding.py      # åµŒå…¥å‘é‡ç”Ÿæˆ
```

## å®‰è£…å’Œé…ç½®

### 1. å®‰è£…ä¾èµ–

ä½¿ç”¨ uv å®‰è£…ä¾èµ–ï¼š

```bash
cd crybaby/langgraph-demo
uv add .
```

æˆ–è€…æ‰‹åŠ¨å®‰è£…ï¼š

```bash
pip install -e .
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶é…ç½®ï¼š

```bash
cp .env.example .env
```

ä¸»è¦é…ç½®é¡¹ï¼š
- `OPENAI_API_KEY`: OpenAI APIå¯†é’¥
- `VECTOR_DB_TYPE`: å‘é‡æ•°æ®åº“ç±»å‹ï¼ˆqdrant/milvus/weaviateï¼‰
- å¯¹åº”å‘é‡æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯

### 3. å¯åŠ¨å‘é‡æ•°æ®åº“

#### Qdrant
```bash
docker run -p 6333:6333 qdrant/qdrant
```

#### Milvus
```bash
# ä½¿ç”¨docker-composeå¯åŠ¨
curl -sfL https://raw.githubusercontent.com/milvus-io/milvus/master/scripts/standalone_embed.sh -o standalone_embed.sh
bash standalone_embed.sh start
```

#### Weaviate
```bash
docker run -p 8080:8080 -p 50051:50051 semitechnologies/weaviate:latest
```

## ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨ Streamlit å‰ç«¯

```bash
python -m streamlit run streamlit_app.py
```

### ä½¿ç”¨ LangGraph Serverï¼ˆå¯é€‰ï¼‰

```bash
langgraph dev
```

### åŸºæœ¬ä½¿ç”¨æµç¨‹

1. **ä¸Šä¼ æ–‡æ¡£**ï¼šåœ¨ä¾§è¾¹æ ä¸Šä¼  PDFã€DOCX æˆ– PPT æ–‡ä»¶
2. **ç­‰å¾…å¤„ç†**ï¼šç³»ç»Ÿè‡ªåŠ¨è§£æã€åˆ†å—å¹¶å­˜å…¥å‘é‡æ•°æ®åº“
3. **æé—®**ï¼šåœ¨ä¸»ç•Œé¢è¾“å…¥é—®é¢˜ï¼Œç³»ç»Ÿä¼šï¼š
   - æ£€ç´¢ç›¸å…³æ–‡æ¡£å—
   - åæ€æ£€ç´¢ç»“æœ
   - å¦‚æœä¸è¶³ï¼Œä¼˜åŒ–æŸ¥è¯¢å¹¶é‡æ–°æ£€ç´¢ï¼ˆè¿­ä»£ï¼‰
   - ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ

## æ ¸å¿ƒæ¶æ„

### å›¾RAGå·¥ä½œæµ

```
å¼€å§‹
  â†“
æ£€ç´¢ (retrieve)
  â†“
åæ€ (reflect)
  â†“
æ˜¯å¦éœ€è¦è¿­ä»£ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ ä¼˜åŒ–æŸ¥è¯¢ (refine_query) â†’ æ£€ç´¢
  â””â”€ å¦ â†’ ç”Ÿæˆç­”æ¡ˆ (generate_answer)
  â†“
ç»“æŸ
```

### é«˜å¯ç”¨è®¾è®¡

- **æŠ½è±¡åŸºç±»**ï¼šæ‰€æœ‰å‘é‡æ•°æ®åº“å®ç°ç»Ÿä¸€æ¥å£
- **å·¥å‚æ¨¡å¼**ï¼šæ”¯æŒåŠ¨æ€åˆ‡æ¢æ•°æ®åº“ç±»å‹
- **æ•…éšœè½¬ç§»**ï¼šé«˜å¯ç”¨åŒ…è£…å™¨è‡ªåŠ¨åˆ‡æ¢å¤‡ä»½æ•°æ®åº“
- **å¼€é—­åŸåˆ™**ï¼šæ–°å¢æ•°æ®åº“ç±»å‹åªéœ€å®ç°æ¥å£ï¼Œæ— éœ€ä¿®æ”¹å…¶ä»–ä»£ç 

## æŠ€æœ¯æ ˆ

- **LangGraph**: å›¾å·¥ä½œæµç¼–æ’
- **LangChain**: LLMåº”ç”¨æ¡†æ¶
- **OpenAI**: GPT-4o-mini å’Œ text-embedding-3-small
- **å‘é‡æ•°æ®åº“**: Qdrant / Milvus / Weaviate
- **æ–‡æ¡£è§£æ**: PyPDF2, python-docx, python-pptx
- **å‰ç«¯**: Streamlit

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å‘é‡æ•°æ®åº“

1. åœ¨ `vector_store/` ç›®å½•åˆ›å»ºæ–°çš„å®ç°ç±»ï¼Œç»§æ‰¿ `VectorStore`
2. åœ¨ `factory.py` ä¸­æ·»åŠ åˆ›å»ºé€»è¾‘
3. åœ¨ `config.py` ä¸­æ·»åŠ é…ç½®æ”¯æŒ

### è‡ªå®šä¹‰åˆ†å—ç­–ç•¥

ä¿®æ”¹ `data_processor/chunker.py` ä¸­çš„ `FinancialChunker` ç±»ã€‚

### è°ƒæ•´RAGå‚æ•°

ä¿®æ”¹ `.env` æ–‡ä»¶ä¸­çš„ RAG é…ç½®é¡¹ã€‚

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
